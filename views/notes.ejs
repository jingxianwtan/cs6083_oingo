<% include ./_layouts/header %>
<h2 class="page-title">Notes</h2>
<a href="/notes/add-note" class="btn btn-primary">Add a new note</a>
<a href="/my_notes" class="btn btn-primary">My notes</a>

<br><br>

<form method="post" action="/my_states/set-current">
    <select name="currState">
        <option value="default">Default</option>
        <% myStates.forEach(function(state) { %>
            <% if (currState === state.name) { %>
                <option selected="selected" value="<%= state.name %>"><%= state.name %></option>
            <% } else { %>
                <option value="<%= state.name %>"><%= state.name %></option>
            <% } %>
        <% }) %>
    </select>
    <button class="btn btn-default">Set State</button>
</form>

<br><br>

<form>
    <label for="">Your default current location is at {lat: 40.7539278, lon: -73.9865007}.</label>
    <label for="">Your real current time is <%= utils.getDateTimeString(currDT) %>.</label>
    <input type="text" class="form-control" name="currLat" value="<%= currLat %>">
    <input type="text" class="form-control" name="currLon" value="<%= currLon %>">
    <input type="text" class="form-control" name="currDT" value="<%= utils.getDateTimeString(currDT) %>">
    <button class="btn btn-default" formmethod="post" formaction="/notes/curr_time_and_location/custom/<%= currState %>">Set Customized Time and Location</button>
    <button class="btn btn-default" formmethod="post" formaction="/notes/curr_time_and_location/default/<%= currState %>">Set Real Time and Default Location</button>
</form>

<br><br>

<div>
    <% if (!notesWithQuote.length) { %>
        <div>No active notes are available at this time and location! </div>
    <% } else { %>
        <% notesWithQuote.forEach(function(noteWithQuote) { %>
            <div class="note-area">
                <% if (noteWithQuote.original_postby != null) { %>
                <div class="original-note">
                    <div><%- `Reply: ${utils.clickableUserName(noteWithQuote.original_postby)}: ${utils.textWithClickableTags(noteWithQuote.original_text)}` %></div>
                    <div class="note-timestamp"><%= `Posted at: ${utils.getDateTimeString(noteWithQuote.original_ts)}` %></div>
                </div>
                <% } %>
                <div class="note-content"><%- `${utils.clickableUserName(noteWithQuote.username)}: ${utils.textWithClickableTags(noteWithQuote.text)}` %></div>
                <div>
                    <div class="note-timestamp"><%= `Posted at: ${utils.getDateTimeString(noteWithQuote.timestamp)}` %></div>
                    <div class="reply-click"><a href="/notes/<%= noteWithQuote.note_id %>/reply">Reply</a></div>
                </div>
            </div>
        <% }); %>
    <% } %>
</div>

<% include ./_layouts/footer %>
